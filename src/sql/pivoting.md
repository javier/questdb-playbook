# Pivoting Results

Imagine you have this query, in which you are calculating volume of operations per minute for each different `id`. You
will get a row for each minute and different `id` value.

```sql
SELECT timestamp, id, SUM(price) AS total
FROM nasdaq_trades
SAMPLE BY 1m
LIMIT 10;
```

|         timestamp          |  id   |       total        |
|----------------------------|-------|--------------------|
| 2023-09-05 16:00:00.000000 | AVGO  | 5240.9099731445285 |
| 2023-09-05 16:00:00.000000 | GOOGL | 2846.9310607910083 |
| 2023-09-05 16:00:00.000000 | AMD   |  5084.672119140602 |
| 2023-09-05 16:00:00.000000 | MSFT  | 11323.302673339831 |
| 2023-09-05 16:00:00.000000 | AAPL  |  7579.874008178689 |
| 2023-09-05 16:00:00.000000 | AMZN  | 4912.1144866943205 |
| 2023-09-05 16:00:00.000000 | TSLA  | 12145.930419921853 |
| 2023-09-05 16:00:00.000000 | NVDA  | 18821.522888183586 |
| 2023-09-05 16:00:00.000000 | META  |  7453.722381591787 |
| 2023-09-05 16:01:00.000000 | AMD   |  5334.774894714332 |


Now let's say you want to have a single row per minute, and one column for each different `id` representing the total.
This is called `pivoting` and can be done using a conditional statement like this:

```sql
SELECT timestamp,
SUM(CASE WHEN id='AAPL' THEN price end) as AAPL,
SUM(CASE WHEN id='AMD' THEN price end) as AMD,
SUM(CASE WHEN id='AMZN' THEN price end) as AMZN,
SUM(CASE WHEN id='AVGO' THEN price end) as AVGO,
SUM(CASE WHEN id='GOOGL' THEN price end) as GOOGL,
SUM(CASE WHEN id='META' THEN price end) as META,
SUM(CASE WHEN id='MSFT' THEN price end) as MSFT,
SUM(CASE WHEN id='NVDA' THEN price end) as NVDA,
SUM(CASE WHEN id='TSLA' THEN price end) as TSLA,
FROM nasdaq_trades
SAMPLE BY 1m
LIMIT 10;
```

|         timestamp          |        AAPL        |        AMD        |        AMZN        |        AVGO        |       GOOGL        |       META        |        MSFT        |        NVDA        |        TSLA        |
|----------------------------|--------------------|-------------------|--------------------|--------------------|--------------------|-------------------|--------------------|--------------------|--------------------|
| 2023-09-05 16:00:00.000000 |  7579.874008178689 | 5084.672119140602 | 4912.1144866943205 | 5240.9099731445285 | 2846.9310607910083 | 7453.722381591787 | 11323.302673339831 | 18821.522888183586 | 12145.930419921853 |
| 2023-09-05 16:01:00.000000 |  7391.459899902319 | 5334.774894714332 | 4095.1175842285015 | 4370.4683227539035 | 2984.1311950683476 | 8653.660156249989 |  9993.825775146472 |  16910.06411743163 | 13683.176284790028 |
| 2023-09-05 16:02:00.000000 |  6443.294494628891 | 5430.157814025858 | 3960.1438903808394 |   6111.73187255859 | 2170.4004821777257 | 8659.099212646468 |  9331.380340576161 |   17397.9634399414 | 10891.317306518535 |
| 2023-09-05 16:03:00.000000 |  7202.075607299784 | 4538.430877685529 |  4643.736602783189 |  7853.859374999998 | 3392.1089172363186 | 5373.722778320306 | 10004.424957275378 | 20302.754211425774 | 11394.964996337878 |
| 2023-09-05 16:04:00.000000 |  7200.806854248028 | 5296.689399719217 |  5051.699874877909 |  4361.820007324216 |  2577.578720092764 | 7762.194580078118 | 11003.722686767565 | 19809.971191406243 | 10377.095489501933 |
| 2023-09-05 16:05:00.000000 | 5493.8547821044785 | 5064.818710327128 | 3684.8054351806545 | 2615.1400146484357 |   3118.46304321288 | 4179.964294433587 |  7668.204040527331 | 17389.004882812493 | 11382.535476684552 |
| 2023-09-05 16:06:00.000000 |  7765.655593872049 |  5051.05449676512 |   4365.74842834471 |  5224.199462890623 |  3117.898910522448 | 7162.115997314447 |  7667.368652343742 | 16896.767730712883 | 10118.141311645491 |
| 2023-09-05 16:07:00.000000 |  5494.578430175772 | 4961.245986938453 |  4097.552322387678 |  5229.344665527342 |  2033.874801635734 | 6273.977172851552 |  9674.531951904284 | 18364.494873046868 | 11645.225952148421 |
| 2023-09-05 16:08:00.000000 |  5874.678726196272 |  4960.34751129148 |  4507.280120849594 |  2615.249938964843 | 2034.6537017822186 | 7173.646453857414 |  9006.780578613269 | 14976.878692626948 | 11137.094818115222 |
| 2023-09-05 16:09:00.000000 |  6442.485992431626 | 4625.540107727032 | 3688.8210906982317 |  5231.304199218748 | 2305.4280853271416 | 4484.199249267571 |  8007.038146972646 | 13045.136840820303 | 11642.798614501937 |
